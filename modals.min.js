var PinnedBubbleViewport=function(e){function t(t){e.call(this,t,JST.pinnedviewport(),"viewport-pinned","content",false);this.parameters={left:0,top:0}}__extends(t,e);t.prototype.show=function(t){e.prototype.show.call(this);this.root.css({left:n(this.parameters.left,this.root.width(),$(window).width()),top:n(this.parameters.top,this.root.height(),$(window).height())});this.frame.css({opacity:1});window.setTimeout(t,350)};t.prototype.hide=function(t){e.prototype.hide.call(this);var n=this;this.frame.css({opacity:0});window.setTimeout(function(){n.root.remove();if(t)t()},350)};var n=function(e,t,n){return n-e>t?e:e-t};return t}(WitBox.Viewport);var BorderedViewport=function(e){function t(t,n){e.call(this,t,JST.borderedviewport(),"viewport-bordered","content",true,true,n)}__extends(t,e);t.prototype.show=function(t){e.prototype.show.call(this);this.frame.css({opacity:1});window.setTimeout(t,350)};t.prototype.hide=function(t){e.prototype.hide.call(this);var n=this;this.frame.css({opacity:0});window.setTimeout(function(){n.root.remove();if(t)t()},350)};return t}(WitBox.Viewport);var ConfirmModal=function(e){function t(t){e.call(this,t);this.parameters={text:""};this.callbacks={ok:[],cancel:[]};this.templateObj=JST.confirmmodal}__extends(t,e);t.prototype.initTemplate=function(){e.prototype.initTemplate.call(this)};return t}(WitBox.Modal);var AlertModal=function(e){function t(t){e.call(this,t);this.parameters={text:""};this.callbacks={ok:[]};this.templateObj=JST.alertmodal}__extends(t,e);t.prototype.initTemplate=function(){e.prototype.initTemplate.call(this)};return t}(WitBox.Modal);var BorderedPinnedViewport=function(e){function t(t,n){e.call(this,t,JST.borderedpinnedviewport(),"viewport-bordered-pinned","content",true,true,n)}__extends(t,e);t.prototype.show=function(t){e.prototype.show.call(this);this.frame.css({opacity:1});window.setTimeout(t,350)};t.prototype.hide=function(t){e.prototype.hide.call(this);var n=this;this.frame.css({opacity:0});window.setTimeout(function(){n.root.remove();if(t)t()},350)};return t}(WitBox.Viewport);var YTModal=function(e){function t(t){e.call(this,t);this.parameters={yt:""};this.templateObj=JST.ytmodal}__extends(t,e);t.prototype.initTemplate=function(){e.prototype.initTemplate.call(this)};return t}(WitBox.Modal);var GaleryViewport=function(e){function n(t,n){e.call(this,t,JST.galeryviewport(),"viewport-galery","content",true,false,n);this.parameters={pages:[]}}__extends(n,e);var t=0;n.prototype.show=function(t){e.prototype.show.call(this);this.init();this.frame.css({opacity:1});window.setTimeout(t,350)};n.prototype.hide=function(t){e.prototype.hide.call(this);var n=this;this.frame.css({opacity:0});window.setTimeout(function(){n.root.remove();if(t)t()},350)};n.prototype.load=function(e){var t=this;var n=null;var r=t.parameters.pages[e];t.content.children().css({opacity:0});window.setTimeout(function(){t.content.empty();switch(r.type){case"img":n=$(JST.galerymodalimg(r));break;case"yt":n=$(JST.galerymodalyt(r));break}t.content.append(n);n.css({opacity:0});n.load(function(){$.data(n[0],"width",n.width());$.data(n[0],"height",n.height());$(window).trigger("resize");window.setTimeout(function(){n.css({opacity:1})},r.type=="img"?350:500)})},350)};n.prototype.refresh_pages=function(){var e=this;e.root.find(".page").removeClass("checked");$.each(e.root.find(".page"),function(e,n){if($(n).data("id")==t){$(n).addClass("checked");return}})};n.prototype.init=function(){var e=this;t=0;e.root.find(".prev-button").click(function(){if(--t<0)t=e.parameters.pages.length-1;e.refresh_pages();e.load(t)});e.root.find(".next-button").click(function(){if(++t>e.parameters.pages.length-1)t=0;e.refresh_pages();e.load(t)});$(window).resize(function(){var t=e.content.children();var n=$.data(t[0],"width");var r=$.data(t[0],"height");if(n>window.innerWidth*.2||r>window.innerHeight*.2){if(n/r>window.innerWidth/window.innerHeight){t.css({width:window.innerWidth*.7,height:r/n*window.innerWidth*.7})}else{t.css({width:n/r*window.innerHeight*.7,height:window.innerHeight*.7})}}e.content.css({width:t.width()+"px",height:t.height()+"px"});e.content.parent().css({opacity:1,left:window.innerWidth/2-t.width()/2+"px",top:window.innerHeight/2-t.height()/2+"px"})});$.each(e.parameters.pages,function(t,n){if(n.type=="img")(new Image).src=n.url;e.root.find(".pages").append($('<span class="page'+(t==0?' checked"':'"')+' data-id="'+t+'">'+(t+1)+"</span>"))});e.root.find(".page").click(function(){e.root.find(".page").removeClass("checked");$(this).addClass("checked");t=$(this).data("id");e.load(t)});e.load(0)};return n}(WitBox.Viewport);WitBoxFactory.showConfirm=function(e,t,n){(new WitBox.Dialog(BorderedViewport,ConfirmModal,{ok:{click:t},cancel:{click:n}},{text:e})).show()};WitBoxFactory.showAlert=function(e,t){(new WitBox.Dialog(BorderedViewport,AlertModal,{ok:{click:t}},{text:e},true)).show()};WitBoxFactory.showYT=function(e){(new WitBox.Dialog(BorderedPinnedViewport,YTModal,null,{yt:e},true)).show()};WitBoxFactory.showGalery=function(e){(new WitBox.Dialog(GaleryViewport,null,null,{pages:e},true)).show()}